var M=Object.defineProperty;var D=(i,e,t)=>e in i?M(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var l=(i,e,t)=>D(i,typeof e!="symbol"?e+"":e,t);import{M as T,L as N,S,P as A,N as P,g as d,a as $,C as x}from"./vendor2.js";function p(i,e){i.setAttribute("src",e)}const E=document.querySelectorAll(".js-item-product");if(E.length){const i=new T("#modal-product");E.forEach(e=>{const t=e.getAttribute("data-event").split(","),s={event:{click:t.includes("click"),hover:t.includes("hover")},floor:e.getAttribute("data-floor"),scheme:e.getAttribute("data-scheme"),title:e.getAttribute("data-title")};s.event.hover&&e.addEventListener("mouseenter",()=>{if(window.innerWidth>580){console.log(1);const n=document.querySelector(".js-scheme-main");n&&p(n,s.scheme)}}),s.event.click&&e.addEventListener("click",n=>{window.innerWidth<580&&(n.preventDefault(),i._element.querySelector(".js-modal-product-title").innerText=s.title,i._element.querySelector(".js-modal-product-floor").innerText=s.floor,p(i._element.querySelector(".js-scheme"),s.scheme),i.show())})})}const m=document.querySelector(".js-modal-menu"),L=document.querySelector(".js-button-burger"),q=document.querySelector(".js-part-header");m&&(new T(m,{backdrop:!1}),m.addEventListener("show.bs.modal",()=>{window.scrollTo(0,0),q.style.zIndex=1e3,L.classList.add("is-active")}),m.addEventListener("hide.bs.modal",()=>{q.style.zIndex="auto",L.classList.remove("is-active")}));const v=new N;function k(i){v.raf(i),requestAnimationFrame(k)}requestAnimationFrame(k);const B=i=>{for(const e of i)if(e.type==="attributes"&&e.attributeName==="class"){const{target:t}=e;t.classList.contains("modal")&&(t.classList.contains("show")?v.stop():v.start())}},H=new MutationObserver(B),W={attributeFilter:["class"],attributes:!0,childList:!0,subtree:!0};H.observe(document.body,W);class O{constructor(e){this.section=e,this.mainSliderElements={slider:e.querySelector(".js-products-slider-main"),paginations:e.querySelectorAll(".js-products-slider-main-tabs-pagination")},this.innerSlidersElements=e.querySelectorAll(".js-products-slider-inner"),this.mainSlider={},this.innerSlider={},this.defaultParameterSwiper={slidesPerView:1,slideActiveClass:"is-active"},this.init()}setTabsPagination(e,t,s=!1){const n=t.querySelectorAll(".js-products-slider-tabs-pagination-button");function o(r){t.querySelector(".is-active").classList.remove("is-active"),n[r].classList.add("is-active")}if(n.forEach((r,a)=>{a===0&&s&&r.classList.add("is-active"),r.addEventListener("click",h=>{h.preventDefault(),e.activeIndex!==a&&e.slideTo(a)})}),s)return o}setIndexPagination(e,t){const s=e.snapIndex+1,n=e.pagination.bullets.length;t.innerText=`${(s<10?"0":"")+s} / ${(e.pagination.bullets.length<10?"0":"")+n}`}initMainSlider(){this.mainSlider=new S(this.mainSliderElements.slider,{...this.defaultParameterSwiper,direction:"vertical",speed:500,allowTouchMove:!1,autoHeight:!0}),this.mainSliderElements.paginations.length&&this.mainSliderElements.paginations.forEach(e=>{this.setTabsPagination(this.mainSlider,e)})}initInnerSlider(e,t){const s=e.closest(".swiper-slide"),n=s.querySelector(".js-products-slider-inner-tabs-pagination"),o=s.querySelector(".js-slider-default-pagination-index"),r=s.querySelector(".js-slider-default-pagination-bullet"),a={prev:s.querySelector(".js-slider-default-navigation-prev"),next:s.querySelector(".js-slider-default-navigation-next")},h={...this.defaultParameterSwiper,slidesPerView:"auto",modules:[A,P]};r&&(h.pagination={el:r,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}),a.prev&&a.next&&(h.navigation={prevEl:a.prev,nextEl:a.next}),this.innerSlider[t]=new S(e,h),o&&r&&this.setIndexPagination(this.innerSlider[t],o);const _=this.setTabsPagination(this.innerSlider[t],n,!0);this.innerSlider[t].on("transitionStart",u=>{if(n&&_(u.activeIndex),o&&r&&this.setIndexPagination(u,o),window.innerWidth>1120){const w=u.el.closest(".js-products-slider-main-slide").querySelector(".js-scheme"),C=u.slides[u.snapIndex].querySelector(".js-item-product").getAttribute("data-scheme");w&&p(w,C)}})}init(){this.mainSliderElements.slider&&this.initMainSlider(),this.innerSlidersElements.length&&this.innerSlidersElements.forEach((e,t)=>{this.initInnerSlider(e,t)})}}class F{constructor(e){this.element=e,this.elementSection=e.closest("section"),this.navigation={prev:this.elementSection.querySelector(".js-slider-default-navigation-prev"),next:this.elementSection.querySelector(".js-slider-default-navigation-next")},this.paginationBullet=this.elementSection.querySelector(".js-slider-default-pagination-bullet"),this.paginationIndex=this.elementSection.querySelector(".js-slider-default-pagination-index"),this.parametersSwiper={slidesPerView:"auto",modules:[]},this.parametersSwiperExtra=this.element.getAttribute("data-parameter"),this.parametersSwiperExtra&&(this.parametersSwiper={...this.parametersSwiper,...JSON.parse(this.parametersSwiperExtra)}),window.innerWidth<581&&(this.parametersSwiper.loop=!1,this.parametersSwiper.centeredSlides=!1),this.init()}setPaginationBullet(){this.parametersSwiper.modules.push(A),this.parametersSwiper.pagination={el:this.paginationBullet,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}}setNavigation(){this.parametersSwiper.modules.push(P),this.parametersSwiper.navigation={prevEl:this.navigation.prev,nextEl:this.navigation.next}}getPaginationIndex(e){const t=this.parametersSwiper.loop?e.realIndex+1:e.snapIndex+1,s=e.pagination.bullets.length;return`${(t<10?"0":"")+t} / ${(e.pagination.bullets.length<10?"0":"")+s}`}setPaginationIndex(e){this.paginationIndex.innerText=this.getPaginationIndex(e),e.on("beforeTransitionStart resize",()=>{this.paginationIndex.innerText=this.getPaginationIndex(e)})}init(){this.paginationBullet&&this.setPaginationBullet(),this.navigation.prev&&this.navigation.next&&this.setNavigation(),this.slider=new S(this.element,this.parametersSwiper),this.paginationIndex&&this.paginationBullet&&this.setPaginationIndex(this.slider)}}const g=document.querySelector(".js-fixed-element-section");if(g){const i=g.querySelector(".js-fixed-element");window.addEventListener("scroll",e=>{let t=g.getBoundingClientRect().top;t-window.innerHeight+g.offsetHeight<0||t>0?i.style.opacity=0:i.style.opacity=1})}const j=document.querySelectorAll(".js-form-field");j.length&&j.forEach(i=>{const e=i.querySelector(".js-form-field-clear"),t=i.querySelector(".js-form-field-input");e&&e.addEventListener("click",()=>{t.value="",i.classList.contains("is-error")&&i.classList.remove("is-error")})});class V{constructor(e){this.element=e,this.text=this.element.innerText,this.lengthDesktop=this.element.getAttribute("data-length"),this.lengthMobile=this.element.getAttribute("data-length-mobile"),this.init()}getLengthText(e,t){return{mobile:this.text.length>=t?`${this.text.substring(0,t)}...`:!1,desktop:this.text.length>=e?`${this.text.substring(0,e)}...`:!1}}setNewText(){const e=this.getLengthText(this.lengthDesktop,this.lengthMobile);window.innerWidth>580&&e.desktop?this.element.innerText=e.desktop:e.mobile&&(this.element.innerText=e.mobile)}init(){this.setNewText(),window.addEventListener("resize",()=>{this.setNewText()})}}d.registerPlugin($,x);x.create("title-slide-bottom",".645,.045,.355,1");x.create("text-slide-bottom","0.215, 0.61, 0.355, 1");const f=(i,e,...t)=>{const s=d.utils.toArray(e);return e&&s.length>0?d[i](e,...t):null},c={from:(i,e)=>f("from",i,e),fromTo:(i,e,t)=>f("fromTo",i,e,t),set:(i,e)=>i&&d.utils.toArray(i).length>0?d.set(i,e):null,timeline:i=>d.timeline(i),to:(i,e)=>f("to",i,e)};document.querySelector(".js-part-header");const I=(...i)=>{i.forEach(e=>{[...document.querySelectorAll(e)].forEach(s=>{s.classList.add("overflow-hidden"),s.innerHTML=`<span class="inline-block">${s.textContent}</span>`})})},y=(...i)=>{i.forEach(e=>{[...document.querySelectorAll(e)].forEach(s=>{s.innerHTML=s.textContent.split(" ").map(n=>`
					<div class="inline-block overflow-hidden"><span class="inline-block">${n}</span></div>`).join(" ")})})},J=(i,e=0,t)=>{y(i),c.from(`${i} span`,{delay:e,duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:t||null,stagger:.048,yPercent:110})},G=(i,e=0,t)=>{I(i),c.from(`${i} span`,{delay:e,duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:null,stagger:.048,yPercent:200})};class b{constructor(e,t,s){l(this,"items");l(this,"text");l(this,"title");this.text=t,this.title=e,this.items=s,this.init()}init(){y(this.title),I(this.text),c.from(`${this.title} span`,{duration:1.4,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.title},yPercent:110}),c.from(`${this.text} span`,{duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.text},yPercent:110}),b.showItems(document.querySelectorAll(this.items))}static showItems(e){[...e].forEach(t=>{c.from(t.querySelector(".item-event__date"),{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:t},y:-20}),c.from([...t.lastElementChild.children].slice(0,4),{duration:1,ease:"text-slide-bottom",onStart:()=>{t.classList.add("is-active")},opacity:0,scrollTrigger:{start:"top 90%",trigger:t},stagger:.048,y:50}),c.from(t.lastElementChild.lastElementChild,{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:t},x:-15,y:15})})}}class z{constructor(e){l(this,"isLoading",!1);l(this,"isDone",!1);l(this,"methods",{getMore:async()=>{this.page++,await this.methods.update()},toggleMoreVisibility:e=>{const{more:t}=this.refs;Number(e)<=this.page?(this.isDone=!0,t&&t.classList.add("display-none")):(this.isDone=!1,t&&t.classList.remove("display-none"))},update:async()=>{this.methods.appendSkeleton();const{total_pages:e,list:t}=await this.methods.fetchData();this.methods.removeSkeleton(),this.methods.appendElements(t),this.methods.playItemsAnimation(),this.methods.toggleMoreVisibility(e)},fetchData:async()=>{const e=new FormData(this.container),t=this.container.getAttribute("action");try{return await(await fetch(t,{method:"POST",body:e})).json()}catch(s){alert("Возникла ошибка: "+s.message)}},playItemsAnimation:()=>{const e=this.container.querySelectorAll(".is-loaded");if(!e)return!1;b.showItems(e),e.forEach(t=>t.classList.remove("is-loaded"))},appendSkeleton:()=>{if(!this.existSkeleton)return!1;const{skeleton:e,body:t}=this.refs;for(let s=0;s<this.perPage;s++){const n=e.content.firstElementChild.cloneNode(!0);n.classList.add("js-skeleton"),t.appendChild(n)}},removeSkeleton:()=>{if(!this.existSkeleton)return!1;const{body:e}=this.refs;e.querySelectorAll(".js-skeleton").forEach(s=>s.remove())},appendElements:e=>{if(!e)return!1;const{body:t}=this.refs;e.forEach(s=>{t.insertAdjacentHTML("beforeend",s)})},scrollHandler:async e=>{if(this.isLoading||this.isDone)return!1;const t=this.container.getBoundingClientRect(),n=t.top+window.scrollY+t.height,o=window.pageYOffset,r=n-n/4;o>r&&(console.log("fetch scrollHandler"),this.isLoading=!0,await this.methods.getMore(),this.isLoading=!1)},clickHandler:async e=>{if(e.preventDefault(),this.isLoading)return!1;this.isLoading=!0,this.methods.getMore(),this.isLoading=!1}});l(this,"listeners",{scrollLoad:()=>{const{scroll:e}=this.container.dataset;if(!e)return!1;window.addEventListener("scroll",()=>{this.methods.scrollHandler()})},moreClick:()=>{const{more:e}=this.refs;if(!e)return!1;e.addEventListener("click",this.methods.clickHandler)}});this.container=e,this.selectors={more:".js-listing-more",body:".js-listing-body",inputPage:"input[name='page']",inputPerPage:"input[name='perPage']",skeleton:"#skeleton"},console.log("innit scroll more"),this._refs=null,Object.keys(this.listeners).forEach(t=>{this.listeners[t]()})}get existSkeleton(){const{skeleton:e}=this.refs;return!!e}get refs(){if(!this._refs){this._refs={};for(const e in this.selectors){const t=this.selectors[e];this._refs[e]=this.container.querySelector(t)}}return this._refs}get perPage(){const{inputPerPage:e}=this.refs;return e!=null&&e.value?Number(e.value):10}get page(){const{inputPage:e}=this.refs;return e!=null&&e.value?Number(e.value):1}set page(e){const{inputPage:t}=this.refs;t.value=e}}window.addEventListener("DOMContentLoaded",()=>{y(".modal__menu-link");const i=document.querySelectorAll(".js-slider-default");i.length&&i.forEach(r=>{new F(r)}),document.querySelector(".js-event-container");const e=document.querySelector(".js-products-slider");e&&new O(e);const t=document.querySelectorAll(".js-set-length-text");t.length&&t.forEach(r=>{new V(r)});const s=document.querySelectorAll(".js-filter-item"),n=document.querySelector(".js-scheme-filter");s.length&&s.forEach(r=>{r.addEventListener("click",()=>p(n,r.getAttribute("data-scheme")))});const o=document.querySelectorAll(".js-listing");o!=null&&o.length&&o.forEach(r=>new z(r))});export{b as E,G as a,I as b,c as g,v as l,J as t,y as w};

var B=Object.defineProperty;var D=(s,t,e)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var u=(s,t,e)=>D(s,typeof t!="symbol"?t+"":t,e);import{M as P,L as N,S as x,P as C,N as I,g as p,a as F,C as E}from"./vendor2.js";function _(s,t){s.setAttribute("src",t)}const w=s=>{const t=s||document.querySelectorAll(".js-item-product");if(t.length){const e=new P("#modal-product");t.forEach(i=>{const r=i.getAttribute("data-event").split(","),o={event:{click:r.includes("click"),hover:r.includes("hover")},floor:i.getAttribute("data-floor"),scheme:i.getAttribute("data-scheme"),title:i.getAttribute("data-title"),url:i.getAttribute("href")};o.event.hover&&i.addEventListener("mouseenter",()=>{if(window.innerWidth>580){console.log(1);const a=document.querySelector(".js-scheme-main");a&&_(a,o.scheme)}}),o.event.click&&i.addEventListener("click",a=>{window.innerWidth<580&&(a.preventDefault(),e._element.querySelector(".js-modal-product-title").innerText=o.title,e._element.querySelector(".js-modal-product-floor").innerText=o.floor,e._element.querySelector(".js-modal-product-link").setAttribute("href",o.url),_(e._element.querySelector(".js-scheme"),o.scheme),e.show())})})}},y=document.querySelector(".js-modal-menu"),T=document.querySelector(".js-button-burger"),k=document.querySelector(".js-part-header");y&&(new P(y,{backdrop:!1}),y.addEventListener("show.bs.modal",()=>{k.style.zIndex=1e3,T.classList.add("is-active")}),y.addEventListener("hide.bs.modal",()=>{k.style.zIndex="auto",T.classList.remove("is-active")}));const q=new N;function $(s){q.raf(s),requestAnimationFrame($)}requestAnimationFrame($);const W=s=>{for(const t of s)if(t.type==="attributes"&&t.attributeName==="class"){const{target:e}=t;e.classList.contains("modal")&&(e.classList.contains("show")?q.stop():q.start())}},O=new MutationObserver(W),R={attributeFilter:["class"],attributes:!0,childList:!0,subtree:!0};O.observe(document.body,R);class V{constructor(t){this.section=t,this.mainSliderElements={slider:t.querySelector(".js-products-slider-main"),paginations:t.querySelectorAll(".js-products-slider-main-tabs-pagination")},this.innerSlidersElements=t.querySelectorAll(".js-products-slider-inner"),this.mainSlider={},this.innerSlider={},this.defaultParameterSwiper={slidesPerView:1,slideActiveClass:"is-active"},this.init()}setTabsPagination(t,e,i=!1){const r=e.querySelectorAll(".js-products-slider-tabs-pagination-button");function o(a){e.querySelector(".is-active").classList.remove("is-active"),r[a].classList.add("is-active")}if(r.forEach((a,d)=>{d===0&&i&&a.classList.add("is-active"),a.addEventListener("click",h=>{h.preventDefault(),t.activeIndex!==d&&t.slideTo(d)})}),i)return o}setIndexPagination(t,e){const i=t.snapIndex+1,r=t.pagination.bullets.length;e.innerText=`${(i<10?"0":"")+i} / ${(t.pagination.bullets.length<10?"0":"")+r}`}initMainSlider(){this.mainSlider=new x(this.mainSliderElements.slider,{...this.defaultParameterSwiper,direction:"vertical",speed:500,allowTouchMove:!1,autoHeight:!0}),this.mainSliderElements.paginations.length&&this.mainSliderElements.paginations.forEach(t=>{this.setTabsPagination(this.mainSlider,t)})}initInnerSlider(t,e){const i=t.closest(".swiper-slide"),r=i.querySelector(".js-products-slider-inner-tabs-pagination"),o=i.querySelector(".js-slider-default-pagination-index"),a=i.querySelector(".js-slider-default-pagination-bullet"),d={prev:i.querySelector(".js-slider-default-navigation-prev"),next:i.querySelector(".js-slider-default-navigation-next")},h={...this.defaultParameterSwiper,slidesPerView:"auto",modules:[C,I]};a&&(h.pagination={el:a,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}),d.prev&&d.next&&(h.navigation={prevEl:d.prev,nextEl:d.next}),this.innerSlider[e]=new x(t,h),o&&a&&this.setIndexPagination(this.innerSlider[e],o);const n=this.setTabsPagination(this.innerSlider[e],r,!0);this.innerSlider[e].on("transitionStart",c=>{if(r&&n(c.activeIndex),o&&a&&this.setIndexPagination(c,o),window.innerWidth>1120){const m=c.el.closest(".js-products-slider-main-slide").querySelector(".js-scheme"),v=c.slides[c.snapIndex].querySelector(".js-item-product").getAttribute("data-scheme");m&&_(m,v)}})}init(){this.mainSliderElements.slider&&this.initMainSlider(),this.innerSlidersElements.length&&this.innerSlidersElements.forEach((t,e)=>{this.initInnerSlider(t,e)})}}class Y{constructor(t){this.element=t,this.elementSection=t.closest("section"),this.navigation={prev:this.elementSection.querySelector(".js-slider-default-navigation-prev"),next:this.elementSection.querySelector(".js-slider-default-navigation-next")},this.paginationBullet=this.elementSection.querySelector(".js-slider-default-pagination-bullet"),this.paginationIndex=this.elementSection.querySelector(".js-slider-default-pagination-index"),this.parametersSwiper={slidesPerView:"auto",modules:[]},this.parametersSwiperExtra=this.element.getAttribute("data-parameter"),this.parametersSwiperExtra&&(this.parametersSwiper={...this.parametersSwiper,...JSON.parse(this.parametersSwiperExtra)}),window.innerWidth<581&&(this.parametersSwiper.loop=!1,this.parametersSwiper.centeredSlides=!1),this.init()}setPaginationBullet(){this.parametersSwiper.modules.push(C),this.parametersSwiper.pagination={el:this.paginationBullet,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}}setNavigation(){this.parametersSwiper.modules.push(I),this.parametersSwiper.navigation={prevEl:this.navigation.prev,nextEl:this.navigation.next}}getPaginationIndex(t){const e=this.parametersSwiper.loop?t.realIndex+1:t.snapIndex+1,i=t.pagination.bullets.length;return`${(e<10?"0":"")+e} / ${(t.pagination.bullets.length<10?"0":"")+i}`}setPaginationIndex(t){this.paginationIndex.innerText=this.getPaginationIndex(t),t.on("beforeTransitionStart resize",()=>{this.paginationIndex.innerText=this.getPaginationIndex(t)})}init(){this.paginationBullet&&this.setPaginationBullet(),this.navigation.prev&&this.navigation.next&&this.setNavigation(),this.slider=new x(this.element,this.parametersSwiper),this.paginationIndex&&this.paginationBullet&&this.setPaginationIndex(this.slider)}}const S=document.querySelector(".js-fixed-element-section");if(S){const s=S.querySelector(".js-fixed-element");window.addEventListener("scroll",t=>{if(!s)return!1;let e=S.getBoundingClientRect().top;e-window.innerHeight+S.offsetHeight<0||e>0?s.style.opacity=0:s.style.opacity=1})}const j=document.querySelectorAll(".js-form-field");j.length&&j.forEach(s=>{const t=s.querySelector(".js-form-field-clear"),e=s.querySelector(".js-form-field-input");t&&t.addEventListener("click",()=>{e.value="",s.classList.contains("is-error")&&s.classList.remove("is-error")})});class z{constructor(t){this.element=t,this.text=this.element.innerText,this.lengthDesktop=this.element.getAttribute("data-length"),this.lengthMobile=this.element.getAttribute("data-length-mobile"),this.init()}getLengthText(t,e){return{mobile:this.text.length>=e?`${this.text.substring(0,e)}...`:!1,desktop:this.text.length>=t?`${this.text.substring(0,t)}...`:!1}}setNewText(){const t=this.getLengthText(this.lengthDesktop,this.lengthMobile);window.innerWidth>580&&t.desktop?this.element.innerText=t.desktop:t.mobile&&(this.element.innerText=t.mobile)}init(){this.setNewText(),window.addEventListener("resize",()=>{this.setNewText()})}}p.registerPlugin(F,E);E.create("title-slide-bottom",".645,.045,.355,1");E.create("text-slide-bottom","0.215, 0.61, 0.355, 1");const b=(s,t,...e)=>{const i=p.utils.toArray(t);return t&&i.length>0?p[s](t,...e):null},l={from:(s,t)=>b("from",s,t),fromTo:(s,t,e)=>b("fromTo",s,t,e),set:(s,t)=>s&&p.utils.toArray(s).length>0?p.set(s,t):null,timeline:s=>p.timeline(s),to:(s,t)=>b("to",s,t)};document.querySelector(".js-part-header");const f=(...s)=>{s.forEach(t=>{(typeof t=="string"?[...document.querySelectorAll(t)]:t).forEach(i=>{i.classList.add("overflow-hidden"),i.innerHTML=`<span class="inline-block">${i.textContent.trim()}</span>`})})},g=(...s)=>{s.forEach(t=>{(typeof t=="string"?[...document.querySelectorAll(t)]:t).forEach(i=>{i.innerHTML=i.textContent.trim().split(" ").map(r=>`
					<div class="inline-block overflow-hidden"><span class="inline-block">${r}</span></div>`).join(" ")})})},Z=(s,t=0,e)=>{g(s),l.from(`${s} span`,{delay:t,duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:e||null,stagger:.048,yPercent:110})},U=(s,t=0,e)=>{f(s),l.from(`${s} span`,{delay:t,duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:e||null,stagger:.048,yPercent:200})};class A{constructor(t,e,i){u(this,"items");u(this,"text");u(this,"title");this.text=e,this.title=t,this.items=i,this.init()}init(){g(this.title),f(this.text),l.from(`${this.title} span`,{duration:1.4,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.title},yPercent:110}),l.from(`${this.text} span`,{duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.text},yPercent:110}),A.showItems(document.querySelectorAll(this.items))}static showItems(t){[...t].forEach(e=>{window.innerWidth>1024&&l.from(e.querySelector(".item-event__date"),{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:e},y:-20}),l.from([...e.lastElementChild.children].slice(0,4),{duration:1,ease:"text-slide-bottom",onStart:()=>{e.classList.add("is-active")},opacity:0,scrollTrigger:{start:"top 90%",trigger:e},stagger:.048,y:50}),l.from(e.lastElementChild.lastElementChild,{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:e},x:-15,y:15})})}}class L{constructor(t){u(this,"parentClass",".section-news-slider");t&&(this.parentClass=t),this.init()}animateButton(){l.from(`${this.parentClass}__button`,{opacity:0,scrollTrigger:{start:"top 70%",trigger:`${this.parentClass}__title`},x:50})}static animateItems(t){[...t].forEach(e=>{const i=e.querySelectorAll(".item-news__title");g(i),l.from(e.querySelectorAll(".item-news__title span"),{duration:1,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__title")},stagger:.048,yPercent:110}),l.from(e.querySelector(".item-news__text"),{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__text")},yPercent:110}),l.from(e.querySelector(".item-news__content-bottom"),{opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__content-bottom")},x:-20,y:20})})}animateTitle(){f(`${this.parentClass}__title`),l.from(`${this.parentClass}__title span`,{duration:1.4,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:`${this.parentClass}__title`},yPercent:110})}init(){this.animateTitle(),this.animateButton(),L.animateItems(document.querySelectorAll(`${this.parentClass}__item`))}}class J{constructor(){u(this,"elements",document.querySelectorAll(".ui-button:not(.ui-button_type_circle)"));this.textAnimation()}textAnimation(){this.elements&&this.elements.forEach(t=>{var i;const e=(i=t.textContent)==null?void 0:i.trim();e&&(t.innerHTML=`<div class="ui-button__container">
				<div class="ui-button__outside">${e}</div>
				<div class="ui-button__inside">${e}</div>
			</div>`)})}}const M=s=>{[...s].forEach(t=>{const e=t.querySelectorAll(".item-product__title"),i=t.querySelectorAll(".item-product__text");g(e),f(i),l.from(t.querySelectorAll(".item-product__title span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__title")},stagger:.048,yPercent:110}),l.from(t.querySelectorAll(".item-product__text span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__text")},stagger:.048,y:25}),l.from(t.querySelector(".item-product__image"),{opacity:0,y:30,delay:.22,scrollTrigger:{trigger:t.querySelector(".item-product__image")}})})};M(document.querySelectorAll(".section-products-catalog__item"));const H=s=>{[...s].forEach(t=>{const e=t.querySelectorAll(".item-product__title"),i=t.querySelectorAll(".item-product__text");g(e),f(i),l.from(t.querySelectorAll(".item-product__title span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__title")},stagger:.048,yPercent:110}),l.from(t.querySelectorAll(".item-product__text span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__text")},stagger:.048,y:25}),l.from(t.querySelector(".item-product__button"),{delay:.7,opacity:0,scrollTrigger:{start:"top bottom",trigger:t.querySelector(".item-product__text")},x:-20,y:20})})};H(document.querySelectorAll(".section-products-catalog__item"));class G{constructor(t){u(this,"isLoading",!1);u(this,"isDone",!1);u(this,"methods",{getMore:async()=>(this.page++,await this.methods.update()),toggleMoreVisibility:t=>{const{more:e}=this.refs;Number(t)<=this.page?(this.isDone=!0,e&&e.classList.add("display-none")):(this.isDone=!1,e&&e.classList.remove("display-none"))},update:async()=>{this.methods.appendSkeleton();const{total_pages:t,list:e}=await this.methods.fetchData();this.methods.removeSkeleton(),this.methods.appendElements(e);const i=this.methods.playItemsAnimation();return this.methods.toggleMoreVisibility(t),i},fetchData:async()=>{const t=new FormData(this.container),e=this.container.getAttribute("action");try{return await(await fetch(e,{method:"POST",body:t})).json()}catch(i){alert("Возникла ошибка: "+i.message)}},playItemsAnimation:()=>{const t=this.container.querySelectorAll(".is-loaded");return t?(this.postType==="events"&&A.showItems(t),this.postType==="post"&&L.animateItems(t),this.postType==="institution"&&(M(t),w(t)),this.postType==="premises"&&(H(t),w(t)),t.forEach(e=>e.classList.remove("is-loaded")),t):!1},appendSkeleton:()=>{if(!this.existSkeleton)return!1;const{skeleton:t,body:e}=this.refs;for(let i=0;i<this.perPage;i++){const r=t.content.firstElementChild.cloneNode(!0);r.classList.add("js-skeleton"),e.appendChild(r)}},removeSkeleton:()=>{if(!this.existSkeleton)return!1;const{body:t}=this.refs;t.querySelectorAll(".js-skeleton").forEach(i=>i.remove())},removeElements:()=>{const{body:t}=this.refs;t.innerHTML=""},appendElements:t=>{if(!t)return!1;const{body:e}=this.refs;t.forEach(i=>{e.insertAdjacentHTML("beforeend",i)})},clearState:()=>{this.page=0,this.isDone=!1,this.methods.removeElements()},scrollHandler:async t=>{if(this.isLoading||this.isDone)return!1;const e=this.container.getBoundingClientRect(),r=e.top+window.scrollY+e.height,o=window.pageYOffset,a=r-r/4;o>a&&(console.log("fetch scrollHandler"),this.isLoading=!0,await this.methods.getMore(),this.isLoading=!1)},clickHandler:async t=>{var i;if(t.preventDefault(),this.isLoading)return!1;(i=this.container.dataset)!=null&&i.resetSubmit&&this.methods.clearState(),this.isLoading=!0;const e=await this.methods.getMore();return this.isLoading=!1,e},filterChangeHandler:async t=>{var o;this.methods.clearState();const e=await this.methods.clickHandler(t),i=document.querySelector(".js-scheme-main"),r=e==null?void 0:e[0];if(i&&r){const a=(o=r.dataset)==null?void 0:o.scheme;a&&i.setAttribute("src",a)}},resetContainerInputs:t=>{const e=t==null?void 0:t.querySelectorAll('input[type="checkbox"], input[type="radio"]');if(!e)return!1;e.forEach(i=>{i.checked=!1})}});u(this,"listeners",{scrollLoad:()=>{const{scroll:t}=this.container.dataset;if(!t)return!1;window.addEventListener("scroll",()=>{this.methods.scrollHandler()})},filterChange:()=>{const t=this.container.querySelectorAll(this.selectors.filter);if(!t)return!1;t.forEach(e=>{e.addEventListener("change",this.methods.filterChangeHandler)})},moreClick:()=>{this.container.addEventListener("submit",this.methods.clickHandler)},outsideReset:()=>{const t=document.querySelectorAll(this.selectors.reset);if(!t)return!1;t.forEach(e=>{e.addEventListener("click",i=>{var o;const r=document.querySelector((o=e.dataset)==null?void 0:o.resetContainer);if(!r)return!1;this.methods.resetContainerInputs(r)})})}});this.container=t,this.selectors={more:".js-listing-more",body:".js-listing-body",inputPage:"input[name='page']",inputPerPage:"input[name='perPage']",inputType:"input[name='type']",filter:"input[type='radio'], input[type='checkbox']",filterOuside:".js-listing-outside-input",skeleton:"#skeleton",reset:"[data-reset-container]"},console.log("innit scroll more"),this._refs=null,Object.keys(this.listeners).forEach(e=>{this.listeners[e]()})}get existSkeleton(){const{skeleton:t}=this.refs;return!!t}get refs(){if(!this._refs){this._refs={};for(const t in this.selectors){const e=this.selectors[t];this._refs[t]=this.container.querySelector(e)}}return this._refs}get perPage(){const{inputPerPage:t}=this.refs;return t!=null&&t.value?Number(t.value):10}get postType(){const{inputType:t}=this.refs;return t==null?void 0:t.value}get page(){const{inputPage:t}=this.refs;return t!=null&&t.value?Number(t.value):1}set page(t){const{inputPage:e}=this.refs;e.value=t}}class K{constructor(){this.decorateFooterLinks(),this.initFooterAnimations()}decorateFooterLinks(){document.querySelectorAll(".part-footer__menu-link").forEach(e=>{if(e.querySelector(".part-footer__menu-link__outside"))return;const i=e.textContent.trim();e.innerHTML=`
        <div class="part-footer__menu-link__outside">${i}</div>
        <div class="part-footer__menu-link__inside">${i}</div>`})}initFooterAnimations(){l.timeline({scrollTrigger:{start:"top 80%",trigger:".part-footer"}}).from(".part-footer__menu-link",{duration:1,ease:"title-slide-bottom",opacity:0,stagger:.048,yPercent:110}).from(".part-footer__contacts-item",{opacity:0,stagger:.1,yPercent:50},"-=0.5").from(".part-footer__bottom>*",{opacity:0,stagger:.1,yPercent:-100},"-=0.5")}}window.addEventListener("DOMContentLoaded",()=>{g(".modal__menu-link"),w(),[...document.querySelectorAll(".part-header__menu-link")].forEach(n=>{const c=n.textContent;n.innerHTML=`<div class="part-header__menu-link__outside">${c}</div><div class="part-header__menu-link__inside">${c}</div>`}),document.querySelectorAll(".module-video__video").forEach(n=>{n.play()}),new J,new K;const t=document.querySelectorAll(".js-slider-default");t.length&&t.forEach(n=>{new Y(n)}),document.querySelector(".js-event-container");const e=document.querySelector(".js-products-slider");e&&new V(e);const i=document.querySelectorAll(".js-set-length-text");i.length&&i.forEach(n=>{new z(n)});const r=document.querySelectorAll(".js-filter-item"),o=document.querySelector(".js-scheme-filter");r.length&&r.forEach(n=>{n.addEventListener("click",()=>_(o,n.getAttribute("data-scheme")))});const a=document.querySelectorAll(".js-listing");a!=null&&a.length&&a.forEach(n=>new G(n));const d=document.querySelectorAll(".js-update-label");d!=null&&d.length&&d.forEach(n=>{const c=n.querySelector("input"),m=n.dataset.toSelector,v=document.querySelector(m);c.addEventListener("change",()=>{console.log("change",n.textContent),v.textContent=n.textContent})});let h=0;window.addEventListener("scroll",()=>{const n=document.querySelector(".part-header"),c=document.querySelector(".part-header__inner"),m=c.getBoundingClientRect();window.scrollY>500?(n.style.height=`${m.height}px`,n.classList.add("part-header_moving"),setTimeout(()=>{c.style.transition="transform ease-out 0.3s"},0),window.scrollY<h?n.classList.add("part-header_show"):n.classList.remove("part-header_show")):(n.style.height="",c.style.transition="",n.classList.remove("part-header_show"),n.classList.remove("part-header_moving")),h=window.scrollY})});export{A as E,L as N,U as a,f as b,l as g,q as l,Z as t,g as w};

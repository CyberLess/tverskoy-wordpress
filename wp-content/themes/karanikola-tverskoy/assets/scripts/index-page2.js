var D=Object.defineProperty;var B=(i,t,e)=>t in i?D(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var d=(i,t,e)=>B(i,typeof t!="symbol"?t+"":t,e);import{M as j,L as N,S as b,P as k,N as C,g as m,a as F,C as w}from"./vendor2.js";function _(i,t){i.setAttribute("src",t)}const A=document.querySelectorAll(".js-item-product");if(A.length){const i=new j("#modal-product");A.forEach(t=>{const e=t.getAttribute("data-event").split(","),s={event:{click:e.includes("click"),hover:e.includes("hover")},floor:t.getAttribute("data-floor"),scheme:t.getAttribute("data-scheme"),title:t.getAttribute("data-title")};s.event.hover&&t.addEventListener("mouseenter",()=>{if(window.innerWidth>580){console.log(1);const n=document.querySelector(".js-scheme-main");n&&_(n,s.scheme)}}),s.event.click&&t.addEventListener("click",n=>{window.innerWidth<580&&(n.preventDefault(),i._element.querySelector(".js-modal-product-title").innerText=s.title,i._element.querySelector(".js-modal-product-floor").innerText=s.floor,_(i._element.querySelector(".js-scheme"),s.scheme),i.show())})})}const y=document.querySelector(".js-modal-menu"),T=document.querySelector(".js-button-burger"),L=document.querySelector(".js-part-header");y&&(new j(y,{backdrop:!1}),y.addEventListener("show.bs.modal",()=>{window.scrollTo(0,0),L.style.zIndex=1e3,T.classList.add("is-active")}),y.addEventListener("hide.bs.modal",()=>{L.style.zIndex="auto",T.classList.remove("is-active")}));const x=new N;function I(i){x.raf(i),requestAnimationFrame(I)}requestAnimationFrame(I);const W=i=>{for(const t of i)if(t.type==="attributes"&&t.attributeName==="class"){const{target:e}=t;e.classList.contains("modal")&&(e.classList.contains("show")?x.stop():x.start())}},O=new MutationObserver(W),V={attributeFilter:["class"],attributes:!0,childList:!0,subtree:!0};O.observe(document.body,V);class z{constructor(t){this.section=t,this.mainSliderElements={slider:t.querySelector(".js-products-slider-main"),paginations:t.querySelectorAll(".js-products-slider-main-tabs-pagination")},this.innerSlidersElements=t.querySelectorAll(".js-products-slider-inner"),this.mainSlider={},this.innerSlider={},this.defaultParameterSwiper={slidesPerView:1,slideActiveClass:"is-active"},this.init()}setTabsPagination(t,e,s=!1){const n=e.querySelectorAll(".js-products-slider-tabs-pagination-button");function c(a){e.querySelector(".is-active").classList.remove("is-active"),n[a].classList.add("is-active")}if(n.forEach((a,l)=>{l===0&&s&&a.classList.add("is-active"),a.addEventListener("click",r=>{r.preventDefault(),t.activeIndex!==l&&t.slideTo(l)})}),s)return c}setIndexPagination(t,e){const s=t.snapIndex+1,n=t.pagination.bullets.length;e.innerText=`${(s<10?"0":"")+s} / ${(t.pagination.bullets.length<10?"0":"")+n}`}initMainSlider(){this.mainSlider=new b(this.mainSliderElements.slider,{...this.defaultParameterSwiper,direction:"vertical",speed:500,allowTouchMove:!1,autoHeight:!0}),this.mainSliderElements.paginations.length&&this.mainSliderElements.paginations.forEach(t=>{this.setTabsPagination(this.mainSlider,t)})}initInnerSlider(t,e){const s=t.closest(".swiper-slide"),n=s.querySelector(".js-products-slider-inner-tabs-pagination"),c=s.querySelector(".js-slider-default-pagination-index"),a=s.querySelector(".js-slider-default-pagination-bullet"),l={prev:s.querySelector(".js-slider-default-navigation-prev"),next:s.querySelector(".js-slider-default-navigation-next")},r={...this.defaultParameterSwiper,slidesPerView:"auto",modules:[k,C]};a&&(r.pagination={el:a,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}),l.prev&&l.next&&(r.navigation={prevEl:l.prev,nextEl:l.next}),this.innerSlider[e]=new b(t,r),c&&a&&this.setIndexPagination(this.innerSlider[e],c);const h=this.setTabsPagination(this.innerSlider[e],n,!0);this.innerSlider[e].on("transitionStart",u=>{if(n&&h(u.activeIndex),c&&a&&this.setIndexPagination(u,c),window.innerWidth>1120){const f=u.el.closest(".js-products-slider-main-slide").querySelector(".js-scheme"),H=u.slides[u.snapIndex].querySelector(".js-item-product").getAttribute("data-scheme");f&&_(f,H)}})}init(){this.mainSliderElements.slider&&this.initMainSlider(),this.innerSlidersElements.length&&this.innerSlidersElements.forEach((t,e)=>{this.initInnerSlider(t,e)})}}class R{constructor(t){this.element=t,this.elementSection=t.closest("section"),this.navigation={prev:this.elementSection.querySelector(".js-slider-default-navigation-prev"),next:this.elementSection.querySelector(".js-slider-default-navigation-next")},this.paginationBullet=this.elementSection.querySelector(".js-slider-default-pagination-bullet"),this.paginationIndex=this.elementSection.querySelector(".js-slider-default-pagination-index"),this.parametersSwiper={slidesPerView:"auto",modules:[]},this.parametersSwiperExtra=this.element.getAttribute("data-parameter"),this.parametersSwiperExtra&&(this.parametersSwiper={...this.parametersSwiper,...JSON.parse(this.parametersSwiperExtra)}),window.innerWidth<581&&(this.parametersSwiper.loop=!1,this.parametersSwiper.centeredSlides=!1),this.init()}setPaginationBullet(){this.parametersSwiper.modules.push(k),this.parametersSwiper.pagination={el:this.paginationBullet,bulletClass:"slider-pagination__bullet-item",bulletActiveClass:"slider-pagination__bullet-item_active"}}setNavigation(){this.parametersSwiper.modules.push(C),this.parametersSwiper.navigation={prevEl:this.navigation.prev,nextEl:this.navigation.next}}getPaginationIndex(t){const e=this.parametersSwiper.loop?t.realIndex+1:t.snapIndex+1,s=t.pagination.bullets.length;return`${(e<10?"0":"")+e} / ${(t.pagination.bullets.length<10?"0":"")+s}`}setPaginationIndex(t){this.paginationIndex.innerText=this.getPaginationIndex(t),t.on("beforeTransitionStart resize",()=>{this.paginationIndex.innerText=this.getPaginationIndex(t)})}init(){this.paginationBullet&&this.setPaginationBullet(),this.navigation.prev&&this.navigation.next&&this.setNavigation(),this.slider=new b(this.element,this.parametersSwiper),this.paginationIndex&&this.paginationBullet&&this.setPaginationIndex(this.slider)}}const S=document.querySelector(".js-fixed-element-section");if(S){const i=S.querySelector(".js-fixed-element");window.addEventListener("scroll",t=>{if(!i)return!1;let e=S.getBoundingClientRect().top;e-window.innerHeight+S.offsetHeight<0||e>0?i.style.opacity=0:i.style.opacity=1})}const P=document.querySelectorAll(".js-form-field");P.length&&P.forEach(i=>{const t=i.querySelector(".js-form-field-clear"),e=i.querySelector(".js-form-field-input");t&&t.addEventListener("click",()=>{e.value="",i.classList.contains("is-error")&&i.classList.remove("is-error")})});class Y{constructor(t){this.element=t,this.text=this.element.innerText,this.lengthDesktop=this.element.getAttribute("data-length"),this.lengthMobile=this.element.getAttribute("data-length-mobile"),this.init()}getLengthText(t,e){return{mobile:this.text.length>=e?`${this.text.substring(0,e)}...`:!1,desktop:this.text.length>=t?`${this.text.substring(0,t)}...`:!1}}setNewText(){const t=this.getLengthText(this.lengthDesktop,this.lengthMobile);window.innerWidth>580&&t.desktop?this.element.innerText=t.desktop:t.mobile&&(this.element.innerText=t.mobile)}init(){this.setNewText(),window.addEventListener("resize",()=>{this.setNewText()})}}m.registerPlugin(F,w);w.create("title-slide-bottom",".645,.045,.355,1");w.create("text-slide-bottom","0.215, 0.61, 0.355, 1");const v=(i,t,...e)=>{const s=m.utils.toArray(t);return t&&s.length>0?m[i](t,...e):null},o={from:(i,t)=>v("from",i,t),fromTo:(i,t,e)=>v("fromTo",i,t,e),set:(i,t)=>i&&m.utils.toArray(i).length>0?m.set(i,t):null,timeline:i=>m.timeline(i),to:(i,t)=>v("to",i,t)};document.querySelector(".js-part-header");const g=(...i)=>{i.forEach(t=>{(typeof t=="string"?[...document.querySelectorAll(t)]:t).forEach(s=>{s.classList.add("overflow-hidden"),s.innerHTML=`<span class="inline-block">${s.textContent}</span>`})})},p=(...i)=>{i.forEach(t=>{(typeof t=="string"?[...document.querySelectorAll(t)]:t).forEach(s=>{s.innerHTML=s.textContent.split(" ").map(n=>`
					<div class="inline-block overflow-hidden"><span class="inline-block">${n}</span></div>`).join(" ")})})},Z=(i,t=0,e)=>{p(i),o.from(`${i} span`,{delay:t,duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:e||null,stagger:.048,yPercent:110})},U=(i,t=0,e)=>{g(i),o.from(`${i} span`,{delay:t,duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:e||null,stagger:.048,yPercent:200})};class q{constructor(t,e,s){d(this,"items");d(this,"text");d(this,"title");this.text=e,this.title=t,this.items=s,this.init()}init(){p(this.title),g(this.text),o.from(`${this.title} span`,{duration:1.4,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.title},yPercent:110}),o.from(`${this.text} span`,{duration:1.4,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:this.text},yPercent:110}),q.showItems(document.querySelectorAll(this.items))}static showItems(t){[...t].forEach(e=>{window.innerWidth>1024&&o.from(e.querySelector(".item-event__date"),{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:e},y:-20}),o.from([...e.lastElementChild.children].slice(0,4),{duration:1,ease:"text-slide-bottom",onStart:()=>{e.classList.add("is-active")},opacity:0,scrollTrigger:{start:"top 90%",trigger:e},stagger:.048,y:50}),o.from(e.lastElementChild.lastElementChild,{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top 90%",trigger:e},x:-15,y:15})})}}class E{constructor(t){d(this,"parentClass",".section-news-slider");t&&(this.parentClass=t),this.init()}animateButton(){o.from(`${this.parentClass}__button`,{opacity:0,scrollTrigger:{start:"top 70%",trigger:`${this.parentClass}__title`},x:50})}static animateItems(t){[...t].forEach(e=>{const s=e.querySelectorAll(".item-news__title");p(s),o.from(e.querySelectorAll(".item-news__title span"),{duration:1,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__title")},stagger:.048,yPercent:110}),o.from(e.querySelector(".item-news__text"),{duration:1,ease:"text-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__text")},yPercent:110}),o.from(e.querySelector(".item-news__content-bottom"),{opacity:0,scrollTrigger:{start:"top bottom",trigger:e.querySelector(".item-news__content-bottom")},x:-20,y:20})})}animateTitle(){g(`${this.parentClass}__title`),o.from(`${this.parentClass}__title span`,{duration:1.4,ease:"title-slide-bottom",opacity:0,scrollTrigger:{start:"top bottom",trigger:`${this.parentClass}__title`},yPercent:110})}init(){this.animateTitle(),this.animateButton(),E.animateItems(document.querySelectorAll(`${this.parentClass}__item`))}}class J{constructor(){d(this,"elements",document.querySelectorAll(".ui-button:not(.ui-button_type_circle)"));this.textAnimation()}textAnimation(){this.elements&&this.elements.forEach(t=>{var s;const e=(s=t.textContent)==null?void 0:s.trim();e&&(t.innerHTML=`<div class="ui-button__container">
				<div class="ui-button__outside">${e}</div>
				<div class="ui-button__inside">${e}</div>
			</div>`)})}}const $=i=>{[...i].forEach(t=>{const e=t.querySelectorAll(".item-product__title"),s=t.querySelectorAll(".item-product__text");p(e),g(s),o.from(t.querySelectorAll(".item-product__title span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__title")},stagger:.048,yPercent:110}),o.from(t.querySelectorAll(".item-product__text span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__text")},stagger:.048,y:25}),o.from(t.querySelector(".item-product__image"),{opacity:0,y:30,delay:.22,scrollTrigger:{trigger:t.querySelector(".item-product__image")}})})};$(document.querySelectorAll(".section-products-catalog__item"));const M=i=>{[...i].forEach(t=>{const e=t.querySelectorAll(".item-product__title"),s=t.querySelectorAll(".item-product__text");p(e),g(s),o.from(t.querySelectorAll(".item-product__title span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__title")},stagger:.048,yPercent:110}),o.from(t.querySelectorAll(".item-product__text span"),{duration:1.4,ease:"title-slide-bottom",opacity:0,rotate:1,scrollTrigger:{trigger:t.querySelector(".item-product__text")},stagger:.048,y:25}),o.from(t.querySelector(".item-product__button"),{delay:.7,opacity:0,scrollTrigger:{start:"top bottom",trigger:t.querySelector(".item-product__text")},x:-20,y:20})})};M(document.querySelectorAll(".section-products-catalog__item"));class G{constructor(t){d(this,"isLoading",!1);d(this,"isDone",!1);d(this,"methods",{getMore:async()=>{this.page++,await this.methods.update()},toggleMoreVisibility:t=>{const{more:e}=this.refs;Number(t)<=this.page?(this.isDone=!0,e&&e.classList.add("display-none")):(this.isDone=!1,e&&e.classList.remove("display-none"))},update:async()=>{this.methods.appendSkeleton();const{total_pages:t,list:e}=await this.methods.fetchData();this.methods.removeSkeleton(),this.methods.appendElements(e),this.methods.playItemsAnimation(),this.methods.toggleMoreVisibility(t)},fetchData:async()=>{const t=new FormData(this.container),e=this.container.getAttribute("action");try{return await(await fetch(e,{method:"POST",body:t})).json()}catch(s){alert("Возникла ошибка: "+s.message)}},playItemsAnimation:()=>{const t=this.container.querySelectorAll(".is-loaded");if(!t)return!1;this.postType==="events"&&q.showItems(t),this.postType==="post"&&E.animateItems(t),this.postType==="institution"&&$(t),this.postType==="premises"&&M(t),t.forEach(e=>e.classList.remove("is-loaded"))},appendSkeleton:()=>{if(!this.existSkeleton)return!1;const{skeleton:t,body:e}=this.refs;for(let s=0;s<this.perPage;s++){const n=t.content.firstElementChild.cloneNode(!0);n.classList.add("js-skeleton"),e.appendChild(n)}},removeSkeleton:()=>{if(!this.existSkeleton)return!1;const{body:t}=this.refs;t.querySelectorAll(".js-skeleton").forEach(s=>s.remove())},removeElements:()=>{const{body:t}=this.refs;t.innerHTML=""},appendElements:t=>{if(!t)return!1;const{body:e}=this.refs;t.forEach(s=>{e.insertAdjacentHTML("beforeend",s)})},clearState:()=>{this.page=0,this.isDone=!1,this.methods.removeElements()},scrollHandler:async t=>{if(this.isLoading||this.isDone)return!1;const e=this.container.getBoundingClientRect(),n=e.top+window.scrollY+e.height,c=window.pageYOffset,a=n-n/4;c>a&&(console.log("fetch scrollHandler"),this.isLoading=!0,await this.methods.getMore(),this.isLoading=!1)},clickHandler:async t=>{var e;if(t.preventDefault(),this.isLoading)return!1;(e=this.container.dataset)!=null&&e.resetSubmit&&this.methods.clearState(),this.isLoading=!0,await this.methods.getMore(),this.isLoading=!1},filterChangeHandler:async t=>{this.methods.clearState(),await this.methods.clickHandler(t)}});d(this,"listeners",{scrollLoad:()=>{const{scroll:t}=this.container.dataset;if(!t)return!1;window.addEventListener("scroll",()=>{this.methods.scrollHandler()})},filterChange:()=>{const t=this.container.querySelectorAll(this.selectors.filter);if(!t)return!1;t.forEach(e=>{e.addEventListener("change",this.methods.filterChangeHandler)})},moreClick:()=>{this.container.addEventListener("submit",this.methods.clickHandler)}});this.container=t,this.selectors={more:".js-listing-more",body:".js-listing-body",inputPage:"input[name='page']",inputPerPage:"input[name='perPage']",inputType:"input[name='type']",filter:"input[type='radio'], input[type='checkbox']",filterOuside:".js-listing-outside-input",skeleton:"#skeleton"},console.log("innit scroll more"),this._refs=null,Object.keys(this.listeners).forEach(e=>{this.listeners[e]()})}get existSkeleton(){const{skeleton:t}=this.refs;return!!t}get refs(){if(!this._refs){this._refs={};for(const t in this.selectors){const e=this.selectors[t];this._refs[t]=this.container.querySelector(e)}}return this._refs}get perPage(){const{inputPerPage:t}=this.refs;return t!=null&&t.value?Number(t.value):10}get postType(){const{inputType:t}=this.refs;return t==null?void 0:t.value}get page(){const{inputPage:t}=this.refs;return t!=null&&t.value?Number(t.value):1}set page(t){const{inputPage:e}=this.refs;e.value=t}}class K{constructor(){this.decorateFooterLinks(),this.initFooterAnimations()}decorateFooterLinks(){document.querySelectorAll(".part-footer__menu-link").forEach(e=>{if(e.querySelector(".part-footer__menu-link__outside"))return;const s=e.textContent.trim();e.innerHTML=`
        <div class="part-footer__menu-link__outside">${s}</div>
        <div class="part-footer__menu-link__inside">${s}</div>`})}initFooterAnimations(){o.timeline({scrollTrigger:{start:"top 80%",trigger:".part-footer"}}).from(".part-footer__menu-link",{duration:1,ease:"title-slide-bottom",opacity:0,stagger:.048,yPercent:110}).from(".part-footer__contacts-item",{opacity:0,stagger:.1,yPercent:50},"-=0.5").from(".part-footer__bottom>*",{opacity:0,stagger:.1,yPercent:-100},"-=0.5")}}window.addEventListener("DOMContentLoaded",()=>{p(".modal__menu-link"),[...document.querySelectorAll(".part-header__menu-link")].forEach(r=>{const h=r.textContent;r.innerHTML=`<div class="part-header__menu-link__outside">${h}</div><div class="part-header__menu-link__inside">${h}</div>`}),document.querySelectorAll(".module-video__video").forEach(r=>{r.play()}),new J,new K;const t=document.querySelectorAll(".js-slider-default");t.length&&t.forEach(r=>{new R(r)}),document.querySelector(".js-event-container");const e=document.querySelector(".js-products-slider");e&&new z(e);const s=document.querySelectorAll(".js-set-length-text");s.length&&s.forEach(r=>{new Y(r)});const n=document.querySelectorAll(".js-filter-item"),c=document.querySelector(".js-scheme-filter");n.length&&n.forEach(r=>{r.addEventListener("click",()=>_(c,r.getAttribute("data-scheme")))});const a=document.querySelectorAll(".js-listing");a!=null&&a.length&&a.forEach(r=>new G(r));const l=document.querySelectorAll(".js-update-label");l!=null&&l.length&&l.forEach(r=>{const h=r.querySelector("input"),u=r.dataset.toSelector,f=document.querySelector(u);h.addEventListener("change",()=>{console.log("change",r.textContent),f.textContent=r.textContent})})});export{q as E,E as N,U as a,g as b,o as g,x as l,Z as t,p as w};
